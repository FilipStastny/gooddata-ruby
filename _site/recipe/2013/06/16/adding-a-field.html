<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>GoodData Ruby GEM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- Le styles -->
    <link href="http://sdk.gooddata.com/gooddata-ruby/css/bootstrap.css" rel="stylesheet">
    <link href="http://sdk.gooddata.com/gooddata-ruby/gooddata-ruby/css/syntax.css" rel="stylesheet">

    <style type="text/css">
      body {
        padding-top: 20px;
        padding-bottom: 40px;
      }

      /* Custom container */
      .container-narrow {
        margin: 0 auto;
        max-width: 700px;
      }
      .container-narrow > hr {
        margin: 30px 0;
      }

      /* Main marketing message and sign up button */
      .jumbotron {
        padding: 60px 0;
        text-align: center;
      }
      .jumbotron h1 {
        font-size: 72px;
        line-height: 1;
      }
      .jumbotron .btn {
        font-size: 21px;
        padding: 14px 24px;
      }

      /* Supporting marketing content */
      .marketing {
        margin: 60px 0;
      }
      .marketing p + h4 {
        margin-top: 28px;
      }
      
      img.centered {
        margin: 30px auto;
        display: block;
/*        border: 1px solid red;*/
      }
    </style>
    <link href="../assets/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="../assets/js/html5shiv.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="../assets/ico/apple-touch-icon-144-precomposed.png">
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="../assets/ico/apple-touch-icon-114-precomposed.png">
      <link rel="apple-touch-icon-precomposed" sizes="72x72" href="../assets/ico/apple-touch-icon-72-precomposed.png">
                    <link rel="apple-touch-icon-precomposed" href="../assets/ico/apple-touch-icon-57-precomposed.png">
                                   <link rel="shortcut icon" href="../assets/ico/favicon.png">
  </head>

  <body>

    <div >

      <div class="navbar navbar-inverse navbar-fixed-top">
  <div class="navbar-inner">
    <div style="margin-left: 100px;">
      <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="brand" href="./index.html">BAM!</a>
      <div class="nav-collapse collapse container">
        <ul class="nav">
          <li class="">
            <a href="http://sdk.gooddata.com/gooddata-ruby/">Home</a>
          </li>
          <li class="">
            <a href="http://sdk.gooddata.com/gooddata-ruby/getting-started">Get started</a>
          </li>
          <li class="active">
            <a href="http://sdk.gooddata.com/gooddata-ruby/tutorials">Tutorials</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<div class="container-narrow" style="margin-top: 40px;">
  <h2>Adding a field to a dataset</h2>
  <p>Suppose your project works as expected, but you need to add a field. In BAM, the basic steps are as follows:</p>

<ul>
<li>You must acquire the data for that field.</li>

<li>You must create a field in your sink.</li>
</ul>

<p>Suppose your tap looks like the following:</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
   <span class='nt'>&quot;source&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;salesforce&quot;</span>
  <span class='p'>,</span><span class='nt'>&quot;object&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;User&quot;</span>
  <span class='p'>,</span><span class='nt'>&quot;id&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;user&quot;</span>
  <span class='p'>,</span><span class='nt'>&quot;incremental&quot;</span> <span class='p'>:</span> <span class='kc'>true</span>
  <span class='p'>,</span><span class='nt'>&quot;fields&quot;</span> <span class='p'>:</span> <span class='p'>[{</span>
      <span class='nt'>&quot;name&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;Id&quot;</span>
    <span class='p'>},{</span>
      <span class='nt'>&quot;name&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;Name&quot;</span>
    <span class='p'>}]</span>
<span class='p'>}</span>
</code></pre></div>
<p>The sink looks like the following:</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
  <span class='nt'>&quot;target&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;gooddata&quot;</span><span class='p'>,</span>
  <span class='nt'>&quot;id&quot;</span><span class='p'>:</span> <span class='s2'>&quot;owner_dim&quot;</span><span class='p'>,</span>
  <span class='nt'>&quot;gd_name&quot;</span><span class='p'>:</span> <span class='s2'>&quot;opp_owner&quot;</span><span class='p'>,</span>
  <span class='nt'>&quot;fields&quot;</span><span class='p'>:</span> <span class='p'>[{</span>
    <span class='nt'>&quot;type&quot;</span><span class='p'>:</span> <span class='s2'>&quot;attribute&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;name&quot;</span><span class='p'>:</span> <span class='s2'>&quot;id&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;meta&quot;</span><span class='p'>:</span> <span class='s2'>&quot;Id&quot;</span>
  <span class='p'>},</span> <span class='p'>{</span>
    <span class='nt'>&quot;type&quot;</span><span class='p'>:</span> <span class='s2'>&quot;label&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;for&quot;</span><span class='p'>:</span> <span class='s2'>&quot;id&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;name&quot;</span><span class='p'>:</span> <span class='s2'>&quot;name&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;meta&quot;</span><span class='p'>:</span> <span class='s2'>&quot;Name&quot;</span>
  <span class='p'>}]</span>
<span class='p'>}</span>
</code></pre></div>
<p>Let’s do the most trivial case where you grab additional field from the source, which is Salesforce in this case. * Another case: you want to do some processing, which is available in the specific tasks of other recipes.</p>

<h4 id="tap">Tap</h4>

<p>First, let’s add the field to the source tap. Let’s say we want to grab a field called <em>Region</em>.</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
   <span class='nt'>&quot;source&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;salesforce&quot;</span>
  <span class='p'>,</span><span class='nt'>&quot;object&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;User&quot;</span>
  <span class='p'>,</span><span class='nt'>&quot;id&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;user&quot;</span>
  <span class='p'>,</span><span class='nt'>&quot;incremental&quot;</span> <span class='p'>:</span> <span class='kc'>true</span>
  <span class='p'>,</span><span class='nt'>&quot;fields&quot;</span> <span class='p'>:</span> <span class='p'>[{</span>
      <span class='nt'>&quot;name&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;Id&quot;</span>
    <span class='p'>},</span> <span class='p'>{</span>
      <span class='nt'>&quot;name&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;Name&quot;</span>
    <span class='p'>},{</span>
      <span class='nt'>&quot;name&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;Region&quot;</span>
    <span class='p'>}]</span>
<span class='p'>}</span>
</code></pre></div>
<p>The tap is updated.</p>

<p><em>NOTE:</em> It is important to download the fields correctly for storage. For more information, see (Limitations of Event Store)[/recipe/2013/06/16/limitation-of-event-store.html].</p>

<h4 id="sink">Sink</h4>

<p>In the sink, you can simply add a reference to the attribute and then call a BAM function to update the dataset. * <em>NOTE:</em> For more complex manipulations, such as creating new datasets and moving items between datasets, please make your modifications in CloudConnect LDM Modeler.</p>

<p>The update to the sink looks like the following:</p>
<div class='highlight'><pre><code class='json'><span class='p'>{</span>
  <span class='nt'>&quot;target&quot;</span> <span class='p'>:</span> <span class='s2'>&quot;gooddata&quot;</span><span class='p'>,</span>
  <span class='nt'>&quot;id&quot;</span><span class='p'>:</span> <span class='s2'>&quot;owner_dim&quot;</span><span class='p'>,</span>
  <span class='nt'>&quot;gd_name&quot;</span><span class='p'>:</span> <span class='s2'>&quot;opp_owner&quot;</span><span class='p'>,</span>
  <span class='nt'>&quot;fields&quot;</span><span class='p'>:</span> <span class='p'>[{</span>
    <span class='nt'>&quot;type&quot;</span><span class='p'>:</span> <span class='s2'>&quot;attribute&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;name&quot;</span><span class='p'>:</span> <span class='s2'>&quot;id&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;meta&quot;</span><span class='p'>:</span> <span class='s2'>&quot;Id&quot;</span>
  <span class='p'>},</span> <span class='p'>{</span>
    <span class='nt'>&quot;type&quot;</span><span class='p'>:</span> <span class='s2'>&quot;label&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;for&quot;</span><span class='p'>:</span> <span class='s2'>&quot;id&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;name&quot;</span><span class='p'>:</span> <span class='s2'>&quot;name&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;meta&quot;</span><span class='p'>:</span> <span class='s2'>&quot;Name&quot;</span>
  <span class='p'>},</span> <span class='p'>{</span>
    <span class='nt'>&quot;type&quot;</span><span class='p'>:</span> <span class='s2'>&quot;attribute&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;name&quot;</span><span class='p'>:</span> <span class='s2'>&quot;region&quot;</span><span class='p'>,</span>
    <span class='nt'>&quot;meta&quot;</span><span class='p'>:</span> <span class='s2'>&quot;Region&quot;</span>
  <span class='p'>}]</span>
<span class='p'>}</span>
</code></pre></div>
<p>The field named <em>region</em> of type=attribute has been added to the sink and is sourced from the metadata field <em>Region</em>.</p>

<p>To update the model:</p>
<div class='highlight'><pre><code class='json'><span class='err'>bam</span> <span class='err'>model_sync</span>
</code></pre></div>
<p><em>NOTE:</em> You must have CL tool installed.</p>

<p>If the command is successful, the model is updated.</p>

<p>To run the ETL:</p>
<div class='highlight'><pre><code class='json'><span class='err'>bam</span> <span class='err'>generate</span>
</code></pre></div>
</div>

      <hr>

      <div class="footer" style="text-align: center; font-size: 70%;">
        <p>&copy; GoodData 2013</p>
        <p>Pictograms used on this page are from <a href="http://www.defaulticon.com/">http://www.defaulticon.com/</a> created by <a href="http://www.interactivemania.com/">http://www.interactivemania.com/</a></p>
      </div>

    </div> <!-- /container -->

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap-transition.js"></script>
    <script src="/js/bootstrap-alert.js"></script>
    <script src="/js/bootstrap-modal.js"></script>
    <script src="/js/bootstrap-dropdown.js"></script>
    <script src="/js/bootstrap-scrollspy.js"></script>
    <script src="/js/bootstrap-tab.js"></script>
    <script src="/js/bootstrap-tooltip.js"></script>
    <script src="/js/bootstrap-popover.js"></script>
    <script src="/js/bootstrap-button.js"></script>
    <script src="/js/bootstrap-collapse.js"></script>
    <script src="/js/bootstrap-carousel.js"></script>
    <script src="/js/bootstrap-typeahead.js"></script>

  </body>
</html>
